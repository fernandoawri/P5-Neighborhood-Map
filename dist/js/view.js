function callback(e,i){i==google.maps.places.PlacesServiceStatus.OK?createMapMarker(e[0]):vM.viewModel.showToast("Sorry place not found")}function pinPoster(e){for(var i in e){var o={query:e[i].location};service.textSearch(o,callback)}}function initializeMap(){var e={disableDefaultUI:!0};map=new google.maps.Map(document.querySelector("#map"),e),service=new google.maps.places.PlacesService(map),infoWindow=new google.maps.InfoWindow({content:"marker"}),window.mapBounds=new google.maps.LatLngBounds,pinPoster(vM.viewModel.centers()),google.maps.event.addListener(map,"click",function(){$("#righ-sidebar").removeClass("is-visible"),infoWindow.close()})}function createMapMarker(e){var i=e.geometry.location.lat(),o=e.geometry.location.lng(),t=e.name,n=window.mapBounds,a=e.formatted_address,l=new google.maps.Marker({map:map,animation:google.maps.Animation.DROP,position:e.geometry.location,title:t});vM.viewModel.markers.push(l);var s=!1;for(item in vM.viewModel.addedPlacesList)d=vM.viewModel.addedPlacesList[item],l.title===d.name&&(s=!0);if("APP"===vM.viewModel.newFrom||"FIREBASE"===vM.viewModel.newFrom&&s){var d={name:t,location:a};vM.viewModel.addedList.push(d);var r=!0;vM.viewModel.dbLoaded===!1&&(vM.viewModel.updatedFirebase(),r=!1),vM.viewModel.showToast(t+" added to list");var c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+a;infoWindow.setContent("<h3>"+t+"</h3><h4>"+a+'</h4><br><center><img class="street-view-img" src="'+c+'"><button id="more-info" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored"><i class="material-icons mdl-list__item-icon" style="color: white;">visibility</i> - Show info</button></center>'),r===!1&&infoWindow.open(map,l),$("#more-info").click(function(){$(this).text(function(e,i){return"Hide info"===i?"Show info":"Hide info"}),$("#righ-sidebar").toggleClass("is-visible")}),"APP"===vM.viewModel.newFrom&&(vM.viewModel.newFrom="NULL"),vM.viewModel.currentInfo(d),vM.viewModel.loadInfoSelected()}google.maps.event.addListener(l,"click",function(){null!==l.getAnimation()?l.setAnimation(null):l.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){l.setAnimation(null)},1400);var e="",i=!0;for(center in vM.viewModel.addedList())modelName=vM.viewModel.addedList()[center].name,modelName===t&&(i=!1,c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+vM.viewModel.addedList()[center].location,e="<h3>"+vM.viewModel.addedList()[center].name+"</h3><h4>"+vM.viewModel.addedList()[center].location+'</h4><center><img class="street-view-img" src="'+c+'">',vM.viewModel.currentInfo(vM.viewModel.addedList()[center]));if(i)for(center in vM.viewModel.centers())modelName=vM.viewModel.centers()[center].name,modelName===t&&(c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+vM.viewModel.centers()[center].location,e="<h3>"+vM.viewModel.centers()[center].name+"</h3><h4>"+vM.viewModel.centers()[center].location+'</h4><center><img class="street-view-img" src="'+c+'">',vM.viewModel.currentInfo(vM.viewModel.centers()[center]));vM.viewModel.loadInfoSelected();var o;o="Hide info"===$("#more-info").text()?"Hide info":"Show info",e=e+'<br><button id="more-info" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect"><i class="material-icons mdl-list__item-icon" style="color: white;">visibility</i> - '+o+"</button></center>",infoWindow.setContent(e),vM.viewModel.filterFlag||infoWindow.open(map,l),$("#more-info").click(function(){$(this).text(function(e,i){return"Hide info"===i?"Show info":"Hide info"}),$("#righ-sidebar").toggleClass("is-visible")})}),n.extend(new google.maps.LatLng(i,o)),map.fitBounds(n),map.setCenter(n.getCenter())}var map,infoWindow,service,modelName,streetviewUrl,newPlace;window.addEventListener("load",initializeMap),window.addEventListener("resize",function(e){map.fitBounds(mapBounds)});var googleMap='<div id="map"></div>';$("#mapDiv").append(googleMap);
