function callback(e,o){o==google.maps.places.PlacesServiceStatus.OK?(addrStr=e[0].formatted_address,addrStr.indexOf(", PA")>0?createMapMarker(e[0]):vM.viewModel.showToast("City not found in PA, USA")):vM.viewModel.showToast("Sorry place not found")}function pinPoster(e){for(var o in e){var i={query:e[o].location};service.textSearch(i,callback)}}function initializeMap(){var e={disableDefaultUI:!0};map=new google.maps.Map(document.querySelector("#map"),e),service=new google.maps.places.PlacesService(map),infoWindow=new google.maps.InfoWindow({content:"marker"}),window.mapBounds=new google.maps.LatLngBounds,pinPoster(vM.viewModel.centers()),google.maps.event.addListener(map,"click",function(){vM.viewModel.showRighSidebar(!1),infoWindow.close()})}function createMapMarker(e){var o=e.geometry.location.lat(),i=e.geometry.location.lng(),t=e.name,n=window.mapBounds,a=e.formatted_address,d=new google.maps.Marker({map:map,animation:google.maps.Animation.DROP,position:e.geometry.location,title:t});vM.viewModel.markers.push(d);var l=!1;for(item in vM.viewModel.addedPlacesList)s=vM.viewModel.addedPlacesList[item],d.title===s.name&&(l=!0);if("APP"===vM.viewModel.newFrom||"FIREBASE"===vM.viewModel.newFrom&&l){var s={name:t,location:a};vM.viewModel.addedList.push(s);var r=!0;vM.viewModel.dbLoaded===!1&&(vM.viewModel.updatedFirebase(),r=!1),vM.viewModel.showToast(t+" added to list");var c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+a;infoWindow.setContent("<h3>"+t+"</h3><h4>"+a+'</h4><br><img class="street-view-img" src="'+c+'"><button id="more-info" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" onclick="triggerShowSide()"><i class="material-icons mdl-list__item-icon" style="color: white;">visibility</i><span data-bind="text: bottunShowInfo"> - Show info</span></button>'),r===!1&&infoWindow.open(map,d),"APP"===vM.viewModel.newFrom&&(vM.viewModel.newFrom="NULL"),vM.viewModel.currentInfo(s),vM.viewModel.loadInfoSelected()}google.maps.event.addListener(d,"click",function(){null!==d.getAnimation()?d.setAnimation(null):d.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){d.setAnimation(null)},1400);var e="",o=!0;for(center in vM.viewModel.addedList())modelName=vM.viewModel.addedList()[center].name,modelName===t&&(o=!1,c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+vM.viewModel.addedList()[center].location,e="<h3>"+vM.viewModel.addedList()[center].name+"</h3><h4>"+vM.viewModel.addedList()[center].location+'</h4><center><img class="street-view-img" src="'+c+'">',vM.viewModel.currentInfo(vM.viewModel.addedList()[center]));if(o)for(center in vM.viewModel.centers())modelName=vM.viewModel.centers()[center].name,modelName===t&&(c="https://maps.googleapis.com/maps/api/streetview?size=400x200&location="+vM.viewModel.centers()[center].location,e="<h3>"+vM.viewModel.centers()[center].name+"</h3><h4>"+vM.viewModel.centers()[center].location+'</h4><img class="street-view-img" src="'+c+'">',vM.viewModel.currentInfo(vM.viewModel.centers()[center]));vM.viewModel.loadInfoSelected(),e+='<br><button id="more-info" class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored mdl-js-ripple-effect" onclick="triggerShowSide()"><i class="material-icons mdl-list__item-icon" style="color: white;">visibility</i><span data-bind="text: bottunShowInfo"> - Show info</span></button>',infoWindow.setContent(e),vM.viewModel.filterFlag||infoWindow.open(map,d)}),n.extend(new google.maps.LatLng(o,i)),map.fitBounds(n),map.setCenter(n.getCenter())}function triggerShowSide(){vM.viewModel.showRightSideBar()}var map,infoWindow,service,modelName,streetviewUrl,newPlace,addrStr;window.addEventListener("load",initializeMap),window.addEventListener("resize",function(e){map.fitBounds(mapBounds)});
